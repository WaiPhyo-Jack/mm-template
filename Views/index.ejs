<%- include('includes/head.ejs') %>
</head>
<body class="home page page-template page-template-template-portfolio page-template-template-portfolio-php">
	<%- include('includes/loader.ejs') %>
<div id="page">
	<div class="container">
		<%- include('includes/navigation.ejs') %>
		<!-- #masthead -->
		<div id="content" class="site-content">
			<div id="primary" class="content-area column full">
				<main id="main" class="site-main">
					
					<% let currentPage = 1; %>
					<% let itemsPerPage = 6; %>
								
					<% let filteredProjects = projs.filter(project => !project.price > 0); %>
					<% let totalProjects = filteredProjects.length; %>
					<% let totalPages = Math.ceil(totalProjects / itemsPerPage); %>		

					<% if (totalProjects > 0) { %>
						<% let startIdx = (currentPage - 1) * itemsPerPage; %>
						<% let endIdx = startIdx + itemsPerPage; %>
						<% let projectsToShow = filteredProjects.slice(startIdx, endIdx); %>
						<h1>first<%=currentPage %>,<%=startIdx %>,<%=endIdx %>,<%=totalProjects %></h1>
					  <div class="grid portfoliogrid">
						<% for (let project of projectsToShow) { %>
						  <article class="hentry">
							<header class="entry-header">
							  <div class="entry-thumbnail">
								<a href="shopsingle/<%= project._id %>"><img src="../Photo/projectPhoto/<%= project.projectImg[0].fileName %>" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="p1"/></a>
							  </div>
							  <h2 class="entry-title"><a href="shopsingle/<%= project._id %>" rel="bookmark"><%= project.project_name %></a></h2>
							  <a class='portfoliotype' href='#'><%= project.category %></a>
							</header>
						  </article>	
						<% } %>
					  </div>
					  <nav class="pagination">
						<% if (currentPage > 1) { %>
						  <a class="prev page-numbers" href="<%= currentPage - 1 %>">« Prev</a>
						<% } %>
					  
						<% for (let i = 1; i <= totalPages; i++) { %>
						  <% if (i === currentPage) { %>
							<span class="page-numbers current"><%= i %></span>
						  <% } else { %>
							<a class="page-numbers" href="<%= i %>"><%= i %></a>
						  <% } %>
						<% } %>
					  
						<% if (currentPage < totalPages) { %>
						  <a class="next page-numbers" href="?<%= currentPage = currentPage + 1 %>">Next »</a>
						<% } %>
					  </nav>
				<% } else { %>
					<h1>No Products Found!</h1>
				<% } %>
				<!-- .grid -->  
				<br/>
				
				</main>
				<!-- #main -->
			</div>
			<!-- #primary -->
		</div>
		<!-- #content -->
	</div>
	<!-- .container -->
	<%- include('includes/footer.ejs') %>
<!-- #page -->
<%- include('includes/script.ejs') %>
</body>
</html>